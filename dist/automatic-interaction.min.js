!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).AutomaticInteraction={})}(this,(function(t){"use strict";const e={SELECTION:"selection",ZOOM:"zoom",PAN:"pan",FILTER:"filter",SORT:"sort",BRUSH:"brush",HIGHLIGHT:"highlight"},n={SVG_CONTAINER:"svg",SVG_GROUP:"g",SVG_TICK:"tick",TICK_DOMAIN:"domain",DEFAULT_ID:"svg_plot",SVG_MARK:["circle","ellipse","line","polygon","polyline","rect","path"]};function r(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function i(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}var a={value:()=>{}};function o(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new s(r)}function s(t){this._=t}function l(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function u(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function c(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=a,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}s.prototype=o.prototype={constructor:s,on:function(t,e){var n,r=this._,i=l(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=c(r[n],t.name,e);else if(null==e)for(n in r)r[n]=c(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=u(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new s(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var f="http://www.w3.org/1999/xhtml",h={svg:"http://www.w3.org/2000/svg",xhtml:f,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function g(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),h.hasOwnProperty(e)?{space:h[e],local:t}:t}function d(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===f&&e.documentElement.namespaceURI===f?e.createElement(t):e.createElementNS(n,t)}}function p(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function _(t){var e=g(t);return(e.local?p:d)(e)}function m(){}function y(t){return null==t?m:function(){return this.querySelector(t)}}function v(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function x(){return[]}function b(t){return null==t?x:function(){return this.querySelectorAll(t)}}function w(t){return function(){return this.matches(t)}}function k(t){return function(e){return e.matches(t)}}var A=Array.prototype.find;function M(){return this.firstElementChild}var E=Array.prototype.filter;function C(){return Array.from(this.children)}function N(t){return new Array(t.length)}function B(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function R(t){return function(){return t}}function S(t,e,n,r,i,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new B(t,a[s]);for(;s<l;++s)(o=e[s])&&(i[s]=o)}function T(t,e,n,r,i,a,o){var s,l,u,c=new Map,f=e.length,h=a.length,g=new Array(f);for(s=0;s<f;++s)(l=e[s])&&(g[s]=u=o.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<h;++s)u=o.call(t,a[s],s,a)+"",(l=c.get(u))?(r[s]=l,l.__data__=a[s],c.delete(u)):n[s]=new B(t,a[s]);for(s=0;s<f;++s)(l=e[s])&&c.get(g[s])===l&&(i[s]=l)}function L(t){return t.__data__}function z(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function I(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function X(t){return function(){this.removeAttribute(t)}}function q(t){return function(){this.removeAttributeNS(t.space,t.local)}}function H(t,e){return function(){this.setAttribute(t,e)}}function O(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function P(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Y(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function V(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function D(t){return function(){this.style.removeProperty(t)}}function j(t,e,n){return function(){this.style.setProperty(t,e,n)}}function F(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function G(t,e){return t.style.getPropertyValue(e)||V(t).getComputedStyle(t,null).getPropertyValue(e)}function U(t){return function(){delete this[t]}}function K(t,e){return function(){this[t]=e}}function $(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Z(t){return t.trim().split(/^|\s+/)}function Q(t){return t.classList||new W(t)}function W(t){this._node=t,this._names=Z(t.getAttribute("class")||"")}function J(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function tt(t,e){for(var n=Q(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function et(t){return function(){J(this,t)}}function nt(t){return function(){tt(this,t)}}function rt(t,e){return function(){(e.apply(this,arguments)?J:tt)(this,t)}}function it(){this.textContent=""}function at(t){return function(){this.textContent=t}}function ot(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function st(){this.innerHTML=""}function lt(t){return function(){this.innerHTML=t}}function ut(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ct(){this.nextSibling&&this.parentNode.appendChild(this)}function ft(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ht(){return null}function gt(){var t=this.parentNode;t&&t.removeChild(this)}function dt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function pt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _t(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function mt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function yt(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function vt(t,e,n){var r=V(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function xt(t,e){return function(){return vt(this,t,e)}}function bt(t,e){return function(){return vt(this,t,e.apply(this,arguments))}}B.prototype={constructor:B,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},W.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var wt=[null];function kt(t,e){this._groups=t,this._parents=e}function At(){return new kt([[document.documentElement]],wt)}function Mt(t){return"string"==typeof t?new kt([[document.querySelector(t)]],[document.documentElement]):new kt([[t]],wt)}function Et(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}kt.prototype=At.prototype={constructor:kt,select:function(t){"function"!=typeof t&&(t=y(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],l=s.length,u=r[i]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new kt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return v(t.apply(this,arguments))}}(t):b(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new kt(r,i)},selectChild:function(t){return this.select(null==t?M:function(t){return function(){return A.call(this.children,t)}}("function"==typeof t?t:k(t)))},selectChildren:function(t){return this.selectAll(null==t?C:function(t){return function(){return E.call(this.children,t)}}("function"==typeof t?t:k(t)))},filter:function(t){"function"!=typeof t&&(t=w(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new kt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,L);var n=e?T:S,r=this._parents,i=this._groups;"function"!=typeof t&&(t=R(t));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],f=i[u],h=f.length,g=z(t.call(c,c&&c.__data__,u,r)),d=g.length,p=s[u]=new Array(d),_=o[u]=new Array(d),m=l[u]=new Array(h);n(c,f,p,_,m,g,e);for(var y,v,x=0,b=0;x<d;++x)if(y=p[x]){for(x>=b&&(b=x+1);!(v=_[b])&&++b<d;);y._next=v||null}}return(o=new kt(o,r))._enter=s,o._exit=l,o},enter:function(){return new kt(this._enter||this._groups.map(N),this._parents)},exit:function(){return new kt(this._exit||this._groups.map(N),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u,c=n[l],f=r[l],h=c.length,g=s[l]=new Array(h),d=0;d<h;++d)(u=c[d]||f[d])&&(g[d]=u);for(;l<i;++l)s[l]=n[l];return new kt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=I);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(e)}return new kt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=g(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?q:X:"function"==typeof e?n.local?Y:P:n.local?O:H)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?D:"function"==typeof e?F:j)(t,e,null==n?"":n)):G(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?U:"function"==typeof e?$:K)(t,e)):this.node()[t]},classed:function(t,e){var n=Z(t+"");if(arguments.length<2){for(var r=Q(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?rt:e?et:nt)(n,e))},text:function(t){return arguments.length?this.each(null==t?it:("function"==typeof t?ot:at)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?st:("function"==typeof t?ut:lt)(t)):this.node().innerHTML},raise:function(){return this.each(ct)},lower:function(){return this.each(ft)},append:function(t){var e="function"==typeof t?t:_(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:_(t),r=null==e?ht:"function"==typeof e?e:y(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(gt)},clone:function(t){return this.select(t?pt:dt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=_t(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?yt:mt,r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?bt:xt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const Ct={capture:!0,passive:!1};function Nt(t){t.preventDefault(),t.stopImmediatePropagation()}function Bt(t,e){var n=t.document.documentElement,r=Mt(t).on("dragstart.drag",null);e&&(r.on("click.drag",Nt,Ct),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Rt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function St(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Tt(){}var Lt=.7,zt=1/Lt,It="\\s*([+-]?\\d+)\\s*",Xt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ht=/^#([0-9a-f]{3,8})$/,Ot=new RegExp("^rgb\\("+[It,It,It]+"\\)$"),Pt=new RegExp("^rgb\\("+[qt,qt,qt]+"\\)$"),Yt=new RegExp("^rgba\\("+[It,It,It,Xt]+"\\)$"),Vt=new RegExp("^rgba\\("+[qt,qt,qt,Xt]+"\\)$"),Dt=new RegExp("^hsl\\("+[Xt,qt,qt]+"\\)$"),jt=new RegExp("^hsla\\("+[Xt,qt,qt,Xt]+"\\)$"),Ft={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Gt(){return this.rgb().formatHex()}function Ut(){return this.rgb().formatRgb()}function Kt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Ht.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?$t(e):3===n?new Jt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Zt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Zt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ot.exec(t))?new Jt(e[1],e[2],e[3],1):(e=Pt.exec(t))?new Jt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Yt.exec(t))?Zt(e[1],e[2],e[3],e[4]):(e=Vt.exec(t))?Zt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Dt.exec(t))?re(e[1],e[2]/100,e[3]/100,1):(e=jt.exec(t))?re(e[1],e[2]/100,e[3]/100,e[4]):Ft.hasOwnProperty(t)?$t(Ft[t]):"transparent"===t?new Jt(NaN,NaN,NaN,0):null}function $t(t){return new Jt(t>>16&255,t>>8&255,255&t,1)}function Zt(t,e,n,r){return r<=0&&(t=e=n=NaN),new Jt(t,e,n,r)}function Qt(t){return t instanceof Tt||(t=Kt(t)),t?new Jt((t=t.rgb()).r,t.g,t.b,t.opacity):new Jt}function Wt(t,e,n,r){return 1===arguments.length?Qt(t):new Jt(t,e,n,null==r?1:r)}function Jt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function te(){return"#"+ne(this.r)+ne(this.g)+ne(this.b)}function ee(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ne(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function re(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ae(t,e,n,r)}function ie(t){if(t instanceof ae)return new ae(t.h,t.s,t.l,t.opacity);if(t instanceof Tt||(t=Kt(t)),!t)return new ae;if(t instanceof ae)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new ae(o,s,l,t.opacity)}function ae(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function oe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Rt(Tt,Kt,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Gt,formatHex:Gt,formatHsl:function(){return ie(this).formatHsl()},formatRgb:Ut,toString:Ut}),Rt(Jt,Wt,St(Tt,{brighter:function(t){return t=null==t?zt:Math.pow(zt,t),new Jt(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Lt:Math.pow(Lt,t),new Jt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:te,formatHex:te,formatRgb:ee,toString:ee})),Rt(ae,(function(t,e,n,r){return 1===arguments.length?ie(t):new ae(t,e,n,null==r?1:r)}),St(Tt,{brighter:function(t){return t=null==t?zt:Math.pow(zt,t),new ae(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Lt:Math.pow(Lt,t),new ae(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Jt(oe(t>=240?t-240:t+120,i,r),oe(t,i,r),oe(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var se=t=>()=>t;function le(t){return 1==(t=+t)?ue:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):se(isNaN(e)?n:e)}}function ue(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):se(isNaN(t)?e:t)}var ce=function t(e){var n=le(e);function r(t,e){var r=n((t=Wt(t)).r,(e=Wt(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=ue(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function fe(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var he=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ge=new RegExp(he.source,"g");function de(t,e){var n,r,i,a=he.lastIndex=ge.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=he.exec(t))&&(r=ge.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:fe(n,r)})),a=ge.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}var pe,_e=180/Math.PI,me={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ye(t,e,n,r,i,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*_e,skewX:Math.atan(l)*_e,scaleX:o,scaleY:s}}function ve(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],l=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:fe(t,i)},{i:l-2,x:fe(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:fe(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,l),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:fe(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,l),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:fe(t,n)},{i:s-2,x:fe(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(t){for(var e,n=-1,r=l.length;++n<r;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var xe=ve((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?me:ye(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),be=ve((function(t){return null==t?me:(pe||(pe=document.createElementNS("http://www.w3.org/2000/svg","g")),pe.setAttribute("transform",t),(t=pe.transform.baseVal.consolidate())?ye((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):me)}),", ",")",")");function we(t){return((t=Math.exp(t))+1/t)/2}var ke,Ae,Me=function t(e,n,r){function i(t,i){var a,o,s=t[0],l=t[1],u=t[2],c=i[0],f=i[1],h=i[2],g=c-s,d=f-l,p=g*g+d*d;if(p<1e-12)o=Math.log(h/u)/e,a=function(t){return[s+t*g,l+t*d,u*Math.exp(e*t*o)]};else{var _=Math.sqrt(p),m=(h*h-u*u+r*p)/(2*u*n*_),y=(h*h-u*u-r*p)/(2*h*n*_),v=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-v)/e,a=function(t){var r,i=t*o,a=we(v),c=u/(n*_)*(a*(r=e*i+v,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[s+c*g,l+c*d,u*a/we(e*i+v)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4),Ee=0,Ce=0,Ne=0,Be=0,Re=0,Se=0,Te="object"==typeof performance&&performance.now?performance:Date,Le="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ze(){return Re||(Le(Ie),Re=Te.now()+Se)}function Ie(){Re=0}function Xe(){this._call=this._time=this._next=null}function qe(t,e,n){var r=new Xe;return r.restart(t,e,n),r}function He(){Re=(Be=Te.now())+Se,Ee=Ce=0;try{!function(){ze(),++Ee;for(var t,e=ke;e;)(t=Re-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ee}()}finally{Ee=0,function(){var t,e,n=ke,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:ke=e);Ae=t,Pe(r)}(),Re=0}}function Oe(){var t=Te.now(),e=t-Be;e>1e3&&(Se-=e,Be=t)}function Pe(t){Ee||(Ce&&(Ce=clearTimeout(Ce)),t-Re>24?(t<1/0&&(Ce=setTimeout(He,t-Te.now()-Se)),Ne&&(Ne=clearInterval(Ne))):(Ne||(Be=Te.now(),Ne=setInterval(Oe,1e3)),Ee=1,Le(He)))}function Ye(t,e,n){var r=new Xe;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}Xe.prototype=qe.prototype={constructor:Xe,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?ze():+n)+(null==e?0:+e),this._next||Ae===this||(Ae?Ae._next=this:ke=this,Ae=this),this._call=t,this._time=n,Pe()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pe())}};var Ve=o("start","end","cancel","interrupt"),De=[];function je(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(a){var u,c,f,h;if(1!==n.state)return l();for(u in i)if((h=i[u]).name===n.name){if(3===h.state)return Ye(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[u]):+u<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[u])}if(Ye((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),u=0,c=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=qe(a,0,n.time)}(t,n,{name:e,index:r,group:i,on:Ve,tween:De,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Fe(t,e){var n=Ue(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ge(t,e){var n=Ue(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Ue(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ke(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}function $e(t,e){var n,r;return function(){var i=Ge(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function Ze(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Ge(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function Qe(t,e,n){var r=t._id;return t.each((function(){var t=Ge(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Ue(t,r).value[e]}}function We(t,e){var n;return("number"==typeof e?fe:e instanceof Kt?ce:(n=Kt(e))?(e=n,ce):de)(t,e)}function Je(t){return function(){this.removeAttribute(t)}}function tn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function en(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function nn(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function rn(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttribute(t)}}function an(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttributeNS(t.space,t.local)}}function on(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function sn(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ln(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&sn(t,i)),n}return i._value=e,i}function un(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&on(t,i)),n}return i._value=e,i}function cn(t,e){return function(){Fe(this,t).delay=+e.apply(this,arguments)}}function fn(t,e){return e=+e,function(){Fe(this,t).delay=e}}function hn(t,e){return function(){Ge(this,t).duration=+e.apply(this,arguments)}}function gn(t,e){return e=+e,function(){Ge(this,t).duration=e}}function dn(t,e){if("function"!=typeof e)throw new Error;return function(){Ge(this,t).ease=e}}function pn(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Fe:Ge;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var _n=At.prototype.constructor;function mn(t){return function(){this.style.removeProperty(t)}}function yn(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function vn(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&yn(t,a,n)),r}return a._value=e,a}function xn(t){return function(e){this.textContent=t.call(this,e)}}function bn(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&xn(r)),e}return r._value=t,r}var wn=0;function kn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function An(){return++wn}var Mn=At.prototype;kn.prototype={constructor:kn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=y(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,l,u=r[o],c=u.length,f=a[o]=new Array(c),h=0;h<c;++h)(s=u[h])&&(l=t.call(s,s.__data__,h,u))&&("__data__"in s&&(l.__data__=s.__data__),f[h]=l,je(f[h],e,n,h,f,Ue(s,n)));return new kn(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=b(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,u=r[s],c=u.length,f=0;f<c;++f)if(l=u[f]){for(var h,g=t.call(l,l.__data__,f,u),d=Ue(l,n),p=0,_=g.length;p<_;++p)(h=g[p])&&je(h,e,n,p,g,d);a.push(g),o.push(l)}return new kn(a,o,e,n)},selectChild:Mn.selectChild,selectChildren:Mn.selectChildren,filter:function(t){"function"!=typeof t&&(t=w(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new kn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],f=u.length,h=o[s]=new Array(f),g=0;g<f;++g)(l=u[g]||c[g])&&(h[g]=l);for(;s<r;++s)o[s]=e[s];return new kn(o,this._parents,this._name,this._id)},selection:function(){return new _n(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=An(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=Ue(o,e);je(o,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new kn(r,this._parents,t,n)},call:Mn.call,nodes:Mn.nodes,node:Mn.node,size:Mn.size,empty:Mn.empty,each:Mn.each,on:function(t,e){var n=this._id;return arguments.length<2?Ue(this.node(),n).on.on(t):this.each(pn(n,t,e))},attr:function(t,e){var n=g(t),r="transform"===n?be:We;return this.attrTween(t,"function"==typeof e?(n.local?an:rn)(n,r,Qe(this,"attr."+t,e)):null==e?(n.local?tn:Je)(n):(n.local?nn:en)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=g(t);return this.tween(n,(r.local?ln:un)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?xe:We;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=G(this,t),o=(this.style.removeProperty(t),G(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,mn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=G(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=G(this,t)),o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s))}}(t,r,Qe(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var l=Ge(this,t),u=l.on,c=null==l.value[o]?a||(a=mn(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=G(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,vn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Qe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,bn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Ue(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?$e:Ze)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?cn:fn)(e,t)):Ue(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?hn:gn)(e,t)):Ue(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(dn(e,t)):Ue(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Ge(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--i&&a()}};n.each((function(){var n=Ge(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&a()}))},[Symbol.iterator]:Mn[Symbol.iterator]};var En={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Cn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Nn(t){return t}function Bn(t,e,n,r){this.message=t,this.expected=e,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,Bn)}At.prototype.interrupt=function(t){return this.each((function(){Ke(this,t)}))},At.prototype.transition=function(t){var e,n;t instanceof kn?(e=t._id,t=t._name):(e=An(),(n=En).time=ze(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)(o=s[u])&&je(o,t,e,u,s,n||Cn(o,e));return new kn(r,this._parents,t,e)},function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(Bn,Error),Bn.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?a(t.parts[e][0])+"-"+a(t.parts[e][1]):a(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,i,a=new Array(t.length);for(e=0;e<t.length;e++)a[e]=(i=t[e],n[i.type](i));if(a.sort(),a.length>0){for(e=1,r=1;e<a.length;e++)a[e-1]!==a[e]&&(a[r]=a[e],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."};var Rn=function(t,e){e=void 0!==e?e:{};var n,r={},i={svg_path:Q},a=Q,o=function(t,e){return function(t,e){if(!e)return[t];for(var n=[t],r=0,i=e.length;r<i;r++)n[r+1]=e[r][1];return n}(t,e)},s=/^[Mm]/,l=U(["M","m"],!1,!1),u=/^[Zz]/,c=U(["Z","z"],!1,!1),f=/^[Ll]/,h=U(["L","l"],!1,!1),g=function(t,e){return wt(t,e)},d=/^[Hh]/,p=U(["H","h"],!1,!1),_=/^[Vv]/,m=U(["V","v"],!1,!1),y=/^[Cc]/,v=U(["C","c"],!1,!1),x=/^[Ss]/,b=U(["S","s"],!1,!1),w=/^[Qq]/,k=U(["Q","q"],!1,!1),A=/^[Tt]/,M=U(["T","t"],!1,!1),E=/^[Aa]/,C=U(["A","a"],!1,!1),N=/^[01]/,B=U(["0","1"],!1,!1),R=G(",",!1),S=function(t){return t.join("")},T=".",L=G(".",!1),z=/^[eE]/,I=U(["e","E"],!1,!1),X=/^[+\-]/,q=U(["+","-"],!1,!1),H=/^[0-9]/,O=U([["0","9"]],!1,!1),P=/^[ \t\n\r]/,Y=U([" ","\t","\n","\r"],!1,!1),V=0,D=[{line:1,column:1}],j=0,F=[];if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');a=i[e.startRule]}function G(t,e){return{type:"literal",text:t,ignoreCase:e}}function U(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function K(e){var n,r=D[e];if(r)return r;for(n=e-1;!D[n];)n--;for(r={line:(r=D[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return D[e]=r,r}function $(t,e){var n=K(t),r=K(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Z(t){V<j||(V>j&&(j=V,F=[]),F.push(t))}function Q(){var t,e,n,i,a;for(t=V,e=[],n=_t();n!==r;)e.push(n),n=_t();if(e!==r)if(n=function(){var t,e,n,i,a,s;if(t=V,(e=W())!==r){for(n=[],i=V,a=[],s=_t();s!==r;)a.push(s),s=_t();for(a!==r&&(s=W())!==r?i=a=[a,s]:(V=i,i=r);i!==r;){for(n.push(i),i=V,a=[],s=_t();s!==r;)a.push(s),s=_t();a!==r&&(s=W())!==r?i=a=[a,s]:(V=i,i=r)}n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),n===r&&(n=null),n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(e=function(t){if(!t)return[];for(var e=[],n=0;n<t.length;n++)e=e.concat.apply(e,t[n]);var r=e[0];return r&&"m"==r.code&&(delete r.relative,r.code="M"),e}(n),t=e):(V=t,t=r)}else V=t,t=r;else V=t,t=r;return t}function W(){var e,n,i,a,u,c;if(e=V,n=function(){var e,n,i,a,o,u,c;e=V,s.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(l));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r&&(a=ot())!==r?(o=V,(u=ct())===r&&(u=null),u!==r&&(c=tt())!==r?o=u=[u,c]:(V=o,o=r),o===r&&(o=null),o!==r?(h=o,g=wt(f=n,[a]),h&&(g=g.concat(wt("M"==f?"L":"l",h[1]))),e=n=g):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;var f,h,g;return e}(),n!==r){for(i=[],a=V,u=[],c=_t();c!==r;)u.push(c),c=_t();for(u!==r&&(c=J())!==r?a=u=[u,c]:(V=a,a=r);a!==r;){for(i.push(a),a=V,u=[],c=_t();c!==r;)u.push(c),c=_t();u!==r&&(c=J())!==r?a=u=[u,c]:(V=a,a=r)}i!==r?e=n=o(n,i):(V=e,e=r)}else V=e,e=r;return e}function J(){var e;return(e=function(){var e;V,u.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,Z(c));e!==r&&(e=wt("Z"));return e}())===r&&(e=function(){var e,n,i,a;e=V,f.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(h));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r&&(a=tt())!==r?e=n=g(n,a):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,d.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(p));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r&&(a=et())!==r?e=n=wt(n,a.map((function(t){return{x:t}}))):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,_.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(m));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r&&(a=et())!==r?e=n=wt(n,a.map((function(t){return{y:t}}))):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,y.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(v));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(a=function(){var t,e,n,i,a,s;if(t=V,(e=nt())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=nt())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=nt())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),a!==r?e=n=g(n,a):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,x.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(b));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(a=function(){var t,e,n,i,a,s;if(t=V,(e=rt())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=rt())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=rt())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),a!==r?e=n=g(n,a):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,w.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(k));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(a=function(){var t,e,n,i,a,s;if(t=V,(e=it())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=it())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=it())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),a!==r?e=n=g(n,a):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,A.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(M));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(a=function(){var t,e,n,i,a,s;if(t=V,(e=ot())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=ot())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=ot())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),a!==r?e=n=g(n,a):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}())===r&&(e=function(){var e,n,i,a;e=V,E.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(C));if(n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?(a=function(){var t,e,n,i,a,s;if(t=V,(e=at())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=at())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=at())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}(),a!==r?e=n=g(n,a):(V=e,e=r)):(V=e,e=r)}else V=e,e=r;return e}()),e}function tt(){var t,e,n,i,a,s;if(t=V,(e=ot())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=ot())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=ot())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}function et(){var t,e,n,i,a,s;if(t=V,(e=lt())!==r){for(n=[],i=V,(a=ct())===r&&(a=null),a!==r&&(s=lt())!==r?i=a=[a,s]:(V=i,i=r);i!==r;)n.push(i),i=V,(a=ct())===r&&(a=null),a!==r&&(s=lt())!==r?i=a=[a,s]:(V=i,i=r);n!==r?t=e=o(e,n):(V=t,t=r)}else V=t,t=r;return t}function nt(){var t,e,n,i,a,o,s,l,u;return t=V,(e=ot())!==r?((n=ct())===r&&(n=null),n!==r&&(i=ot())!==r?((a=ct())===r&&(a=null),a!==r&&(o=ot())!==r?(l=i,u=o,t=e={x1:(s=e).x,y1:s.y,x2:l.x,y2:l.y,x:u.x,y:u.y}):(V=t,t=r)):(V=t,t=r)):(V=t,t=r),t}function rt(){var t,e,n,i,a,o;return t=V,(e=ot())!==r?((n=ct())===r&&(n=null),n!==r&&(i=ot())!==r?(o=i,t=e={x2:(a=e).x,y2:a.y,x:o.x,y:o.y}):(V=t,t=r)):(V=t,t=r),t}function it(){var t,e,n,i,a,o;return t=V,(e=ot())!==r?((n=ct())===r&&(n=null),n!==r&&(i=ot())!==r?(o=i,t=e={x1:(a=e).x,y1:a.y,x:o.x,y:o.y}):(V=t,t=r)):(V=t,t=r),t}function at(){var t,e,n,i,a,o,s,l,u,c,f,h;return t=V,(e=st())!==r?((n=ct())===r&&(n=null),n!==r&&(i=st())!==r?((a=ct())===r&&(a=null),a!==r&&(o=lt())!==r&&ct()!==r&&(s=ut())!==r?((l=ct())===r&&(l=null),l!==r&&(u=ut())!==r?((c=ct())===r&&(c=null),c!==r&&(f=ot())!==r?t=e={rx:e,ry:i,xAxisRotation:o,largeArc:s,sweep:u,x:(h=f).x,y:h.y}:(V=t,t=r)):(V=t,t=r)):(V=t,t=r)):(V=t,t=r)):(V=t,t=r),t}function ot(){var t,e,n,i;return t=V,(e=lt())!==r?((n=ct())===r&&(n=null),n!==r&&(i=lt())!==r?t=e={x:e,y:i}:(V=t,t=r)):(V=t,t=r),t}function st(){var t;return V,(t=ht())===r&&(t=pt()),t!==r&&(t=1*t),t}function lt(){var t,e,n;return V,t=V,(e=dt())===r&&(e=null),e!==r&&(n=ht())!==r?t=e=[e,n]:(V=t,t=r),t===r&&(t=V,(e=dt())===r&&(e=null),e!==r&&(n=pt())!==r?t=e=[e,n]:(V=t,t=r)),t!==r&&(t=1*t.join("")),t}function ut(){var e;return V,N.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,Z(B)),e!==r&&(e="1"==e),e}function ct(){var t,e,n,i,a;if(t=V,e=[],(n=_t())!==r)for(;n!==r;)e.push(n),n=_t();else e=r;if(e!==r)if((n=ft())===r&&(n=null),n!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?t=e=[e,n,i]:(V=t,t=r)}else V=t,t=r;else V=t,t=r;if(t===r){if(t=V,e=V,(n=ft())!==r){for(i=[],a=_t();a!==r;)i.push(a),a=_t();i!==r?e=n=[n,i]:(V=e,e=r)}else V=e,e=r;e!==r&&(e=""),t=e}return t}function ft(){var e;return 44===t.charCodeAt(V)?(e=",",V++):(e=r,Z(R)),e}function ht(){var e,n,i;return V,e=V,n=function(){var e,n,i,a;V,e=V,(n=pt())===r&&(n=null);n!==r?(46===t.charCodeAt(V)?(i=T,V++):(i=r,Z(L)),i!==r&&(a=pt())!==r?e=n=[n,i,a]:(V=e,e=r)):(V=e,e=r);e===r&&(e=V,(n=pt())!==r?(46===t.charCodeAt(V)?(i=T,V++):(i=r,Z(L)),i!==r?e=n=[n,i]:(V=e,e=r)):(V=e,e=r));e!==r&&(e=S(e));return e}(),n!==r?((i=gt())===r&&(i=null),i!==r?e=n=[n,i]:(V=e,e=r)):(V=e,e=r),e===r&&(e=V,(n=pt())!==r&&(i=gt())!==r?e=n=[n,i]:(V=e,e=r)),e!==r&&(e=S(e)),e}function gt(){var e,n,i,a;return V,e=V,z.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(I)),n!==r?((i=dt())===r&&(i=null),i!==r&&(a=pt())!==r?e=n=[n,i,a]:(V=e,e=r)):(V=e,e=r),e!==r&&(e=S(e)),e}function dt(){var e;return X.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,Z(q)),e}function pt(){var e,n;if(V,e=[],H.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(O)),n!==r)for(;n!==r;)e.push(n),H.test(t.charAt(V))?(n=t.charAt(V),V++):(n=r,Z(O));else e=r;return e!==r&&(e=e.join("")),e}function _t(){var e;return V,P.test(t.charAt(V))?(e=t.charAt(V),V++):(e=r,Z(Y)),e!==r&&(e=""),e}var mt,yt,vt,xt={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var bt in xt)xt[bt.toUpperCase()]=xt[bt];function wt(t,e){e||(e=[{}]);for(var n=e.length;n--;){var r={code:t,command:xt[t]};for(var i in t==t.toLowerCase()&&(r.relative=!0),e[n])r[i]=e[n][i];e[n]=r}return e}if((n=a())!==r&&V===t.length)return n;throw n!==r&&V<t.length&&Z({type:"end"}),mt=F,yt=j<t.length?t.charAt(j):null,vt=j<t.length?$(j,j+1):$(j,j),new Bn(Bn.buildMessage(mt,yt),mt,yt,vt)};Rn.parseSVG=Rn,Rn.makeAbsolute=function(t){var e,n={x:0,y:0},r={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return t.forEach((function(t){for(var i in"moveto"===t.command&&(e=t),t.x0=n.x,t.y0=n.y,r)i in t&&(t[i]+=t.relative?t[r[i]]:0);"x"in t||(t.x=n.x),"y"in t||(t.y=n.y),t.relative=!1,t.code=t.code.toUpperCase(),"closepath"==t.command&&(t.x=e.x,t.y=e.y),n=t})),t};var Sn=Rn;var Tn=t=>()=>t;function Ln(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function zn(t,e,n){this.k=t,this.x=e,this.y=n}zn.prototype={constructor:zn,scale:function(t){return 1===t?this:new zn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new zn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var In=new zn(1,0,0);function Xn(t){t.stopImmediatePropagation()}function qn(t){t.preventDefault(),t.stopImmediatePropagation()}function Hn(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function On(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Pn(){return this.__zoom||In}function Yn(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Vn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Dn(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function jn(){var t,e,n,r=Hn,i=On,a=Dn,s=Yn,l=Vn,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],f=250,h=Me,g=o("start","zoom","end"),d=500,p=0,_=10;function m(t){t.property("__zoom",Pn).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",E).filter(l).on("touchstart.zoom",C).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(u[0],Math.min(u[1],e)))===t.k?t:new zn(e,t.x,t.y)}function v(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new zn(t.k,r,i)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n,r){t.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,a=arguments,o=w(t,a).event(r),s=i.apply(t,a),l=null==n?x(s):"function"==typeof n?n.apply(t,a):n,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,f="function"==typeof e?e.apply(t,a):e,g=h(c.invert(l).concat(u/c.k),f.invert(l).concat(u/f.k));return function(t){if(1===t)t=f;else{var e=g(t),n=u/e[2];t=new zn(n,l[0]-e[0]*n,l[1]-e[1]*n)}o.zoom(null,t)}}))}function w(t,e,n){return!n&&t.__zooming||new k(t,e)}function k(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function A(t,...e){if(r.apply(this,arguments)){var n=w(this,e).event(t),i=this.__zoom,o=Math.max(u[0],Math.min(u[1],i.k*Math.pow(2,s.apply(this,arguments)))),l=Et(t);if(n.wheel)n.mouse[0][0]===l[0]&&n.mouse[0][1]===l[1]||(n.mouse[1]=i.invert(n.mouse[0]=l)),clearTimeout(n.wheel);else{if(i.k===o)return;n.mouse=[l,i.invert(l)],Ke(this),n.start()}qn(t),n.wheel=setTimeout(f,150),n.zoom("mouse",a(v(y(i,o),n.mouse[0],n.mouse[1]),n.extent,c))}function f(){n.wheel=null,n.end()}}function M(t,...e){if(!n&&r.apply(this,arguments)){var i=t.currentTarget,o=w(this,e,!0).event(t),s=Mt(t.view).on("mousemove.zoom",h,!0).on("mouseup.zoom",g,!0),l=Et(t,i),u=t.clientX,f=t.clientY;o.mouse=[l,this.__zoom.invert(l)],Ke(this),o.start()}function h(t){if(!o.moved){var e=t.clientX-u,n=t.clientY-f;o.moved=e*e+n*n>p}o.event(t).zoom("mouse",a(v(o.that.__zoom,o.mouse[0]=Et(t,i),o.mouse[1]),o.extent,c))}function g(t){s.on("mousemove.zoom mouseup.zoom",null),Bt(t.view,o.moved),o.event(t).end()}}function E(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,o=Et(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(o),l=n.k*(t.shiftKey?.5:2),u=a(v(y(n,l),o,s),i.apply(this,e),c);qn(t),f>0?Mt(this).transition().duration(f).call(b,u,o,t):Mt(this).call(m.transform,u,o,t)}}function C(n,...i){if(r.apply(this,arguments)){var a,o,s,l,u=n.touches,c=u.length,f=w(this,i,n.changedTouches.length===c).event(n);for(Xn(n),o=0;o<c;++o)l=[l=Et(s=u[o],this),this.__zoom.invert(l),s.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,a=!0,f.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(f.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),d)),Ke(this),f.start())}}function N(t,...e){if(this.__zooming){var n,r,i,o,s=w(this,e).event(t),l=t.changedTouches,u=l.length;for(qn(t),n=0;n<u;++n)i=Et(r=l[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=i:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=i);if(r=s.that.__zoom,s.touch1){var f=s.touch0[0],h=s.touch0[1],g=s.touch1[0],d=s.touch1[1],p=(p=g[0]-f[0])*p+(p=g[1]-f[1])*p,_=(_=d[0]-h[0])*_+(_=d[1]-h[1])*_;r=y(r,Math.sqrt(p/_)),i=[(f[0]+g[0])/2,(f[1]+g[1])/2],o=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!s.touch0)return;i=s.touch0[0],o=s.touch0[1]}s.zoom("touch",a(v(r,i,o),s.extent,c))}}function B(t,...r){if(this.__zooming){var i,a,o=w(this,r).event(t),s=t.changedTouches,l=s.length;for(Xn(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),d),i=0;i<l;++i)a=s[i],o.touch0&&o.touch0[2]===a.identifier?delete o.touch0:o.touch1&&o.touch1[2]===a.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(a=Et(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<_)){var u=Mt(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return m.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",Pn),t!==i?b(t,e,n,r):i.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,r){m.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n,r)},m.scaleTo=function(t,e,n,r){m.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,o=null==n?x(t):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(o),l="function"==typeof e?e.apply(this,arguments):e;return a(v(y(r,l),o,s),t,c)}),n,r)},m.translateBy=function(t,e,n,r){m.transform(t,(function(){return a(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},m.translateTo=function(t,e,n,r,o){m.transform(t,(function(){var t=i.apply(this,arguments),o=this.__zoom,s=null==r?x(t):"function"==typeof r?r.apply(this,arguments):r;return a(In.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),r,o)},k.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Mt(this.that).datum();g.call(t,this.that,new Ln(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:g}),e)}},m.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:Tn(+t),m):s},m.filter=function(t){return arguments.length?(r="function"==typeof t?t:Tn(!!t),m):r},m.touchable=function(t){return arguments.length?(l="function"==typeof t?t:Tn(!!t),m):l},m.extent=function(t){return arguments.length?(i="function"==typeof t?t:Tn([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):i},m.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],m):[u[0],u[1]]},m.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(t){return arguments.length?(a=t,m):a},m.duration=function(t){return arguments.length?(f=+t,m):f},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=g.on.apply(g,arguments);return t===g?m:t},m.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,m):Math.sqrt(p)},m.tapDistance=function(t){return arguments.length?(_=+t,m):_},m}function Fn(t,e,n){var r=d3.select("#"+t.state().svg.id);t.state().x_axis.scale&&!t.state().x_axis.ordinal.length&&t.state().x_axis.axis.scale(t.state().x_axis.scale)(),t.state().y_axis.scale&&!t.state().y_axis.ordinal.length&&t.state().y_axis.axis.scale(t.state().y_axis.scale)(),r.append("defs").append("clipPath").attr("id","clip-"+t.state().svg.id).append("rect").attr("x",t.state().x_axis.range[0]).attr("y",t.state().y_axis.range[1]).attr("width",Math.abs(t.state().x_axis.range[1]-t.state().x_axis.range[0])).attr("height",Math.abs(t.state().y_axis.range[0]-t.state().y_axis.range[1]));const i=r.selectAll('[__mark__="true"]');if("_g_clip"!==i.node().parentElement.id){let t=document.createElementNS("http://www.w3.org/2000/svg","g");t.id="_g_clip",i.node().parentElement.appendChild(t),i.nodes().forEach((e=>t.appendChild(e)))}i.node().parentElement.setAttribute("clip-path","url(#clip-"+t.state().svg.id+")");var a=i.node()._global_transform[0]+t.state().svg.getBoundingClientRect().left,o=i.node()._global_transform[1]+t.state().svg.getBoundingClientRect().top,s=r.append("g").attr("id","x-axis-zoom-accessor"),l=r.append("g").attr("id","y-axis-zoom-accessor");let u=d3.zoomIdentity;const c=jn(),f=jn(),h=()=>d3.zoomTransform(s.node()),g=()=>d3.zoomTransform(l.node());s.call(c).attr("pointer-events","none"),l.call(f).attr("pointer-events","none");r.call(jn().on("zoom",(function({sourceEvent:e,transform:n}){e.preventDefault(),t.state().interactions.pan.flag&&(document.getElementById("brush_disam").style.display="block");var d=t.state().interactions.pan.flag,p=t.state().interactions.pan.flag;if(!t.state().x_axis.axis&&!t.state().y_axis.axis)return i.attr("transform",n),void r.selectAll("text").attr("transform",n);const _=n.k/u.k,m=(n.x-u.x)/h().k,y=(n.y-u.y)/g().k;let v=e.clientX-a>t.state().x_axis.range[0],x=e.clientY-o<t.state().y_axis.range[0],b=e.clientX-i.node()._global_transform[0]-t.state().svg.getBoundingClientRect().left,w=e.clientY-i.node()._global_transform[1]-t.state().svg.getBoundingClientRect().top;1===_?!e.shiftKey&&d&&v&&s.call(c.translateBy,m,0):v&&s.call(f.scaleBy,_,[b,w]),t.state().x_axis.ordinal.length?t.state().x_axis.axis.applyTransform(h())():t.state().x_axis.axis.scale(h().rescaleX(t.state().x_axis.scale))();let k="path"===i.node().nodeName&&"ellipse"===i.node().type&&x,A="path"===i.node().nodeName&&"ellipse"!==i.node().type&&x&&!v,M=t.state().x_axis.scale.domain().length>2&&x&&!v,E=2==t.state().x_axis.scale.domain().length&&"path"!==i.node().nodeName&&x;1===_?!e.shiftKey&&p&&(E||k||A||M)&&l.call(f.translateBy,0,y):(E||k||A||M)&&l.call(f.scaleBy,_,[b,w]),t.state().y_axis.axis.scale(g().rescaleY(t.state().y_axis.scale))(),i.attr("transform",(function(){let e=this.__transform.match(/(-?\d+\.?-?\d*)/g),n=(this.getBoundingClientRect().left-this._global_transform[0]-t.state().svg.getBoundingClientRect().left+this.getBoundingClientRect().right-this._global_transform[0]-t.state().svg.getBoundingClientRect().left)/2,r=(this.getBoundingClientRect().top-this._global_transform[1]-t.state().svg.getBoundingClientRect().top+this.getBoundingClientRect().bottom-this._global_transform[1]-t.state().svg.getBoundingClientRect().top)/2;this._t||(this._t=[n,r]);let i=0==+e[0]?0:+e[0]-+this._t[0],a=0==+e[1]?0:+e[1]-+this._t[1],o=h().applyX(+this._t[0])+i,s=g().applyY(+this._t[1])+a,l="path"===this.nodeName&&"ellipse"!==this.type,u=t.state().x_axis.scale.domain().length>2;return l||u?"translate("+h().x+","+g().y+") scale("+h().k+","+g().k+")":"translate("+(this.hasAttribute("cx")?o-this.getAttribute("cx"):o)+","+(this.hasAttribute("cy")?s-this.getAttribute("cy"):s)+")"})),i.attr("vector-effect","non-scaling-stroke"),r.selectAll(".hover").attr("display","none");let C=document.querySelectorAll(".tooltip");C.length&&C.forEach((t=>t.style.visibility="hidden")),u=n})))}function Gn(t,e,n){let r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("fill","gray"),r.setAttribute("opacity",.35),r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",0),r.setAttribute("height",0),r.setAttribute("id","brush-rect"),r.style.cursor="move";let i=t.state().svg;i.appendChild(r);let a=!1,o=[!1,!1];function s(e){t.state().interactions.brush.flag&&(document.getElementById("pan_disam").style.display="block",e.clientX-i.getBoundingClientRect().left>=+r.getAttribute("x")&&e.clientX-i.getBoundingClientRect().left<=+r.getAttribute("x")+ +r.getAttribute("width")&&e.clientY-i.getBoundingClientRect().top>=+r.getAttribute("y")&&e.clientY-i.getBoundingClientRect().top<=+r.getAttribute("y")+ +r.getAttribute("height")||(o[0]?r.setAttribute("width",t.state().x_axis.global_range[1]-t.state().x_axis.global_range[0]):r.setAttribute("width",0),o[1]?r.setAttribute("height",t.state().y_axis.global_range[0]-t.state().y_axis.global_range[1]):r.setAttribute("height",0),e.preventDefault(),a=!0,o[0]?r.setAttribute("x",t.state().x_axis.global_range[0]):r.setAttribute("x",e.clientX-i.getBoundingClientRect().left),o[1]?r.setAttribute("y",t.state().y_axis.global_range[1]):r.setAttribute("y",e.clientY-i.getBoundingClientRect().top)))}function l(e){if(a){e.preventDefault();let n=e.clientX-r.getAttribute("x")-i.getBoundingClientRect().left,a=e.clientY-r.getAttribute("y")-i.getBoundingClientRect().top;o[0]?r.setAttribute("width",t.state().x_axis.global_range[1]-t.state().x_axis.global_range[0]):r.setAttribute("width",n<0?0:n),o[1]?r.setAttribute("height",t.state().y_axis.global_range[0]-t.state().y_axis.global_range[1]):r.setAttribute("height",a<0?0:a),t.filter(+r.getAttribute("x")+ +i.getBoundingClientRect().left,+r.getAttribute("y")+ +i.getBoundingClientRect().top,r.getAttribute("width"),r.getAttribute("height"))}}function u(e){a=!1,0!=+r.getAttribute("width")&&0!=+r.getAttribute("height")||(t.unfilter(),document.getElementById("pan_disam").style.display="none")}i.addEventListener("mousedown",s),i.addEventListener("mousemove",l),i.addEventListener("mouseup",u),e.addEventListener("change",(function(){this.checked||(t.unfilter(),r.setAttribute("width",0),r.setAttribute("height",0)),this.checked?i.addEventListener("mousedown",s):i.removeEventListener("mousedown",s),this.checked?i.addEventListener("mousemove",l):i.removeEventListener("mousemove",l),this.checked?i.addEventListener("mouseup",u):i.removeEventListener("mouseup",u)})),document.querySelectorAll("ul.brush a.axis").forEach((e=>e.addEventListener("click",(function(e){switch(e.target.innerHTML){case"2D":o[0]=o[1]=!1;break;case"X axis":o[0]=!1,o[1]=!0;break;case"Y axis":o[0]=!0,o[1]=!1}0!=+r.getAttribute("width")&&0!=+r.getAttribute("height")&&(o[0]?(r.setAttribute("x",t.state().x_axis.global_range[0]),r.setAttribute("width",t.state().x_axis.global_range[1]-t.state().x_axis.global_range[0])):o[1]&&(r.setAttribute("y",t.state().y_axis.global_range[1]),r.setAttribute("height",t.state().y_axis.global_range[0]-t.state().y_axis.global_range[1])),t.filter(+r.getAttribute("x")+ +i.getBoundingClientRect().left,+r.getAttribute("y")+ +i.getBoundingClientRect().top,r.getAttribute("width"),r.getAttribute("height")))})))),function(t,e,n){var r=0,i=0,a=0,o=0;function s(s){(s=s||window.event).preventDefault(),r=a-s.clientX,i=o-s.clientY,a=s.clientX,o=s.clientY,n[1]||t.setAttribute("y",t.getAttribute("y")-i),n[0]||t.setAttribute("x",t.getAttribute("x")-r),e.filter(+t.getAttribute("x")+ +e.state().svg.getBoundingClientRect().left,+t.getAttribute("y")+ +e.state().svg.getBoundingClientRect().top,t.getAttribute("width"),t.getAttribute("height"))}function l(){t.onmouseup=null,t.onmousemove=null}t.onmousedown=function(e){(e=e||window.event).preventDefault(),a=e.clientX,o=e.clientY,t.onmouseup=l,t.onmousemove=s}}(r,t,o)}function Un(){document.querySelector("#tooltip").style.visibility="hidden"}function Kn(t){if(document.querySelector("#"+t))return;const e=document.createElement("div");e.id=t,e.setAttribute("class","tooltip"),e.style="opacity:0.75; visibility:hidden; position:absolute; background-color:white; z-index:999; border:solid; border-width:2px; border-radius:5px; padding:5px; font-weight:bold;",document.body.insertBefore(e,null)}function $n(t,e){Kn("tooltip"),function(t,e){function n(t){let e=document.querySelector("#tooltip"),n="",r=t.target;for(const[t,e]of Object.entries(r.__inferred__data__))n+=String(t)+": "+String(e),n+="<br/>";e.innerHTML=n,e.style.visibility="visible",e.style.left=t.pageX,e.style.top=t.pageY}function r(e){const n=t.state().svg_marks;var r=0;for(const i of n){++r;let n=i.getAttribute("transform"),a=1,o=0;if(n){let t=n.match(/(-?\d+\.?\d*)/g);o=+t[0],a=+t[2]}let s,l,u=t.state().x_axis.ticks[0].ticks[0].parentNode._global_transform[0]+t.state().svg.getBoundingClientRect().left,c=e.clientX-u,f=t.state().x_axis.range[0],h=i.getTotalLength();for(c<t.state().x_axis.range[0]||t.state().x_axis.range[1]<c?d3.selectAll(".hover").attr("visibility","hidden"):d3.selectAll(".hover").attr("visibility","visible"),c=(c-o)/a;s=Math.floor((f+h)/2),l=i.getPointAtLength(s),s!==h&&s!==f||l.x===c;)if(l.x>c)h=s;else{if(!(l.x<c))break;f=s}let g=l.y+t.state().y_axis.ticks[0].ticks[0].parentNode._global_transform[1],d=t.state().y_axis.scale.invert(g-t.state().y_axis.ticks[0].ticks[0].parentNode._global_transform[1]),p=t.state().x_axis.scale.invert(c);p="number"==typeof p?p.toFixed(2):p;let _=t.state().svg.querySelector("#_circle"+r),m=document.querySelector("#tooltip"+r);m||Kn("tooltip"+r),m=document.querySelector("#tooltip"+r),m.innerHTML="("+p+", "+d.toFixed(2)+")",m.style.visibility="visible",m.style.left=e.pageX+7.5,m.style.top=e.pageY-e.clientY+g+t.state().svg.getBoundingClientRect().top-15,_?(_.setAttribute("cx",c*a+o+t.state().x_axis.ticks[0].ticks[0].parentNode._global_transform[0]),_.setAttribute("cy",g),_.setAttribute("display","")):(_=document.createElementNS("http://www.w3.org/2000/svg","circle"),_.setAttribute("r",5),_.setAttribute("fill","none"),_.setAttribute("stroke","black"),_.setAttribute("stroke-width","1px"),_.id="_circle"+r,_.setAttribute("class","hover"),t.state().svg.append(_),_.setAttribute("cx",c*a+o+t.state().x_axis.ticks[0].ticks[0].parentNode._global_transform[0]),_.setAttribute("cy",g));let y=t.state().svg.querySelector("#_hoverline");y?(y.setAttribute("x1",e.clientX-t.state().svg.getBoundingClientRect().left),y.setAttribute("x2",e.clientX-t.state().svg.getBoundingClientRect().left),y.setAttribute("display","")):(y=document.createElementNS("http://www.w3.org/2000/svg","line"),y.setAttribute("stroke","black"),y.setAttribute("stroke-width",1.5),y.setAttribute("opacity","0.65"),y.setAttribute("class","hover"),y.setAttribute("y1",t.state().y_axis.range[0]+t.state().y_axis.ticks[0].ticks[0].parentNode._global_transform[1]),y.setAttribute("y2",t.state().y_axis.range[1]+t.state().y_axis.ticks[0].ticks[0].parentNode._global_transform[1]),y.setAttribute("x1",e.clientX-t.state().svg.getBoundingClientRect().left),y.setAttribute("x2",e.clientX-t.state().svg.getBoundingClientRect().left),y.id="_hoverline",t.state().svg.append(y))}}for(const e of t.state().svg_marks)e.type&&"ellipse"!==e.type&&(t.state().x_axis.ticks.length||t.state().y_axis.ticks.length)?t.state().svg.addEventListener("mousemove",r):(e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",Un),e.style.cursor="default");e.addEventListener("change",(function(){if(!this.checked){d3.select("#"+t.state().svg.id).selectAll(".hover").attr("display","none");let e=document.querySelectorAll(".tooltip");e.length&&e.forEach((t=>t.style.visibility="hidden"))}for(const e of t.state().svg_marks)e.type&&"ellipse"!==e.type&&(t.state().x_axis.ticks.length||t.state().y_axis.ticks.length)?this.checked?t.state().svg.addEventListener("mousemove",r):t.state().svg.removeEventListener("mousemove",r):(this.checked?e.addEventListener("mouseenter",n):e.removeEventListener("mouseenter",n),this.checked?e.addEventListener("mouseleave",Un):e.removeEventListener("mouseleave",Un))}))}(t,e)}function Zn(t,e){return"translate("+t+","+e+")"}function Qn(t,e){return"translate("+e+","+t+")"}function Wn(t){return e=>+t(e)}function Jn(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function tr(t,e,n){var r=[],i=null,a=null,o=6,s=6,l=3,u="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=1===t||3===t?Zn:Qn,f=null,h=1===t||3===t?0:1,g=null,d=1===t||3===t?n.state().x_axis:n.state().y_axis,p=d.ticks;function _(){var o=null==i?e.ticks?e.ticks.apply(e,r):e.domain():i,s=null==a?e.tickFormat?e.tickFormat.apply(e,r):Nn:a,l=(e.bandwidth?Jn:Wn)(e.copy(),u);function _(t,e){const r=t.getBoundingClientRect().right-t.parentElement._global_transform[0]-n.state().svg.getBoundingClientRect().left;t._t||(t._t=[r,+t.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[0]]);let i=e.applyX(t._t[0]);return i<d.range[0]||i>d.range[1]?t.style.display="none":t.style.display="block",i-t._t[0]+t._t[1]}function m(e,n){let r=e.label,i=e.ticks;r.innerHTML=d.ordinal.length||r.innerHTML==s(n)?r.innerHTML:s(n);let a=r.hasAttribute("transform")?1===t||3===t?r.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[1]:r.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[0]:0,o=r.hasAttribute("transform")?1===t||3===t?r.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[0]:r.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[1]:1===t||3===t?r._global_transform[0]:r._global_transform[1];if(f=null==f?+o-l(n):f,g)var u=c(_(r,g),+Math.abs(a)>.01?+a:0);else u=c(l(n)+(Math.abs(f)<5?f:0)+d.global_range[h]-r._global_transform[h],+Math.abs(a)>.01?+a:0);let p=r.hasAttribute("transform")&&r.getAttribute("transform").includes("rotate")?+r.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g).pop():null;r.setAttribute("transform",u+(p?" rotate("+p+")":""));for(const e of i){let i=e.hasAttribute("transform")?1===t||3===t?e.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[1]:e.getAttribute("transform").match(/(-?\d+\.?\d*e?-?\d*)/g)[0]:0;if(g)var m=c(_(r,g),+Math.abs(a)>.01?+a:0);else m=c(l(n)+d.global_range[h]-r._global_transform[h],+Math.abs(i)>.01?+i:0);e.setAttribute("transform",m)}}o=4===t||2===t?o.reverse():o;for(var y=0;y<o.length&&y<p.length;++y)m(p[y],d.ordinal.length?d.ordinal[y]:o[y]);for(;y<o.length;++y){let t={label:p[0].label.cloneNode(),ticks:p[0].ticks.map((t=>{let e=t.cloneNode();return e._global_transform=t._global_transform,e})),offset:null};t.label._global_transform=p[0].label._global_transform,m(t,o[y]),p[0].label.parentElement.appendChild(t.label),p[0].ticks.forEach(((e,n)=>e.parentElement.appendChild(t.ticks[n]))),p.push(t)}let v=p.length;for(let t=0;y<v;++y){let e=p.length-1-t;p[e].label.remove(),p[e].ticks.forEach((t=>t.remove())),p.pop()}}return _.applyTransform=function(t){return arguments.length?(g=t,_):_},_.scale=function(t){return arguments.length?(e=t,_):e},_.ticks=function(){return r=Array.from(arguments),_},_.tickArguments=function(t){return arguments.length?(r=null==t?[]:Array.from(t),_):r.slice()},_.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),_):i&&i.slice()},_.tickFormat=function(t){return arguments.length?(a=t,_):a},_.tickSize=function(t){return arguments.length?(o=s=+t,_):o},_.tickSizeInner=function(t){return arguments.length?(o=+t,_):o},_.tickSizeOuter=function(t){return arguments.length?(s=+t,_):s},_.tickPadding=function(t){return arguments.length?(l=+t,_):l},_.offset=function(t){return arguments.length?(u=+t,_):u},_}function er(t,e){return tr(3,t,e)}function nr(){var t={has_domain:!1,svg:null,svg_marks:[],text_marks:[],axis_text_marks:[],x_axis:{domain:[null,null],ordinal:[],range:[null,null],global_range:[null,null],ticks:[],scale:null,axis:null},y_axis:{domain:[null,null],ordinal:[],range:[null,null],global_range:[null,null],ticks:[],scale:null,axis:null},legend:[],titles:{x:null,y:null},interactions:{selection:{control:null},zoom:{control:null,axis_control:null},pan:{control:null,axis_control:null,flag:!1},brush:{control:null,axis_control:null,flag:!0},filter:{control:null},sort:{control:null}}},n=function(t,e){let n={};for(let r=0;r<t.ticks.length;++r){let i=t.ticks[r].getBoundingClientRect()[e];t.ticks[r].setAttribute("class",("left"===e?"x-axis":"y-axis")+" tick"),i in n?n[i].ticks.push(t.ticks[r]):n[i]={label:null,ticks:[t.ticks[r]]}}t.ticks=[];for(const[e,r]of Object.entries(n))r.offset=+e,t.ticks.push(r);t.ticks.sort(((t,e)=>+t.offset<+e.offset?-1:+t.offset>+e.offset?1:0))},a=function(t){for(const[e,n]of Object.entries(t.ticks)){let e=n.label.__data__?n.label.__data__:isNaN(parseInt(n.label.innerHTML))?n.label.innerHTML:+n.label.innerHTML.replace(/,/g,"");"string"==typeof e?t.ordinal.push(e):(t.domain[0]=null===t.domain[0]?e:i([t.domain[0],e]),t.domain[1]=null===t.domain[1]?e:r([t.domain[1],e]))}};function o(){}return o.hydrate=function(){document.getElementById("pan-btn").addEventListener("click",(function(e){o.unfilter(),document.getElementById("brush-rect").setAttribute("width",0),document.getElementById("brush-rect").setAttribute("height",0),document.getElementById("pan_disam").style.display="none",t.svg.style.cursor="default",t.interactions.pan.flag=!0,t.interactions.brush.flag=!1})),document.getElementById("brush-btn").addEventListener("click",(function(e){document.getElementById("brush_disam").style.display="none",t.svg.style.cursor="crosshair",t.interactions.pan.flag=!1,t.interactions.brush.flag=!0}));for(const[n,r]of Object.entries(t.interactions))switch(n){case e.SELECTION:$n(o,r.control);break;case e.ZOOM:Fn(o,r.control,r.axis_control);break;case e.PAN:break;case e.BRUSH:t.svg.style.cursor="crosshair",Gn(o,r.control,r.axis_control);break;case e.FILTER:r.control}if("chart"!==t.svg.id)return;let n=document.getElementById("field"),r=t.svg_marks[0].__inferred__data__;for(const[t,e]of Object.entries(r)){let e=document.createElement("option");e.innerHTML=t,n.appendChild(e)}for(const e of t.svg_marks[0].attributes){if("__mark__"===e.nodeName||"style"===e.nodeName)continue;let t=document.createElement("option");t.innerHTML=e.nodeName,n.appendChild(t)}let i=document.getElementById("condition"),a=["<","<=","=",">=",">"];for(const t of a){let e=document.createElement("option");e.innerHTML=t,i.appendChild(e)}},o.infer_mark_attributes=function(){for(const n of t.svg_marks){if(t.text_marks.length){let e=t.text_marks[0].getBoundingClientRect().left,n=t.text_marks[1].getBoundingClientRect().left;t.titles.x=e<n?t.text_marks[1]:t.text_marks[0],t.titles.y=e<n?t.text_marks[0]:t.text_marks[1]}if("path"!==n.nodeName||!t.x_axis.ticks.length&&!t.y_axis.ticks.length||"path"===n.nodeName&&"ellipse"===n.type){if(n.__data__){let t="datum"in n.__data__,r="properties"in n.__data__,i="data"in n.__data__;var e=t?n.__data__.datum:r?n.__data__.properties:i?n.__data__.data:n.__data__}else{let r=(n.getBoundingClientRect().left+n.getBoundingClientRect().right)/2-o.state().x_axis.ticks[0].ticks[0].parentNode._global_transform[0]-o.state().svg.getBoundingClientRect().left,i=(n.getBoundingClientRect().top+n.getBoundingClientRect().bottom)/2-o.state().y_axis.ticks[0].ticks[0].parentNode._global_transform[1]-o.state().svg.getBoundingClientRect().top;e={[t.titles.x.innerHTML]:t.x_axis.scale.invert(r).toFixed(2),[t.titles.y.innerHTML]:t.y_axis.scale.invert(i).toFixed(2)}}n.style["pointer-events"]="fill",n.__inferred__data__=e}}return o},o.state=function(){return t},o.filter=function(e,n,r,i){for(const a of t.svg_marks)+a.getBoundingClientRect().right<e||+a.getBoundingClientRect().left>e+ +r||+a.getBoundingClientRect().bottom<n||+a.getBoundingClientRect().top>n+ +i?a.setAttribute("opacity",.25):a.setAttribute("opacity",1)},o.unfilter=function(){for(const e of t.svg_marks)e.setAttribute("opacity",1)},o.analyze_axes=function(){return n(t.x_axis,"left"),n(t.y_axis,"top"),function(){for(let e=0;e<t.axis_text_marks.length;++e){let n=(+t.axis_text_marks[e].getBoundingClientRect().left+ +t.axis_text_marks[e].getBoundingClientRect().right)/2,r=(+t.axis_text_marks[e].getBoundingClientRect().top+ +t.axis_text_marks[e].getBoundingClientRect().bottom)/2,i=0,a=0;for(let e=0;e<t.x_axis.ticks.length;++e)Math.abs(n-t.x_axis.ticks[e].offset)<Math.abs(n-t.x_axis.ticks[i].offset)&&(i=e);for(let e=0;e<t.y_axis.ticks.length;++e)Math.abs(r-t.y_axis.ticks[e].offset)<Math.abs(r-t.y_axis.ticks[a].offset)&&(a=e);Math.abs(n-t.x_axis.ticks[i].offset)<Math.abs(r-t.y_axis.ticks[a].offset)?t.x_axis.ticks[i].label=t.axis_text_marks[e]:t.y_axis.ticks[a].label=t.axis_text_marks[e],t.axis_text_marks[e].setAttribute("class","tick")}}(),o},o.infer_view=function(){a(t.x_axis),a(t.y_axis);const e=+t.svg.getAttribute("width"),n=+t.svg.getAttribute("height");if(!t.x_axis.ticks.length&&!t.y_axis.ticks.length)return t.x_axis.range=t.x_axis.global_range=[0,e],t.y_axis.range=t.y_axis.global_range=[n,0],o;if(t.has_domain){let e=[].slice.call(t.svg.querySelectorAll(".domain")).map((t=>t.getBoundingClientRect())),n=e[0].width<e[1].width?e[0]:e[1],a=e[0].height<e[1].height?e[0]:e[1];var r=a.left-t.svg.getBoundingClientRect().left,i=a.right-t.svg.getBoundingClientRect().left,s=n.bottom-t.svg.getBoundingClientRect().top,l=n.top-t.svg.getBoundingClientRect().top}else{let n=t.y_axis.ticks[0].ticks[0].getBoundingClientRect(),a=t.x_axis.ticks[0].ticks[0].getBoundingClientRect();r=n.left-t.svg.getBoundingClientRect().left,i=d3.min([n.width+r,e]),s=a.bottom-t.svg.getBoundingClientRect().top,l=d3.max([s-a.height,0])}t.x_axis.global_range=[r,i],t.y_axis.global_range=[s,l],t.x_axis.range=[r,i].map((e=>e-t.x_axis.ticks[0].ticks[0].parentNode._global_transform[0])),t.y_axis.range=[s,l].map((e=>e-t.y_axis.ticks[0].ticks[0].parentNode._global_transform[1]));let u=+t.y_axis.ticks[1].label.innerHTML-+t.y_axis.ticks[0].label.innerHTML,c=+t.y_axis.ticks[2].label.innerHTML-+t.y_axis.ticks[1].label.innerHTML,f=+t.x_axis.ticks[1].label.innerHTML-+t.x_axis.ticks[0].label.innerHTML,h=+t.x_axis.ticks[2].label.innerHTML-+t.x_axis.ticks[1].label.innerHTML,g=t.x_axis.ticks[1].ticks[0].getBoundingClientRect().left-t.x_axis.ticks[0].ticks[0].getBoundingClientRect().left,d=t.x_axis.ticks[2].ticks[0].getBoundingClientRect().left-t.x_axis.ticks[1].ticks[0].getBoundingClientRect().left;if(Math.abs(f-h)>.5||Math.abs(g-d)>.5){if(Math.abs(g-d)<.5){let e=t.x_axis.ticks.ticks[0].childNodes[1].innerHTML;if(e!=t.x_axis.ticks[0].__data__&&"string"==typeof e){var p=e.match(/^(e|\d+)\^(e|\d+)$/),_=e.match(/^(e|d+)([\u2070-\u209F\u00B2\u00B3\u00B9])$/);if(p)m="e"===(m=p[1])?Math.E:parseInt(m);else if(_){var m;m="e"===(m=_[1])?Math.E:parseInt(m)}}}function e(t){let e=Math.log(t)/Math.log(m);return _?"e"+String(e).replace(/\d/g,(function(t){return""[t]})):t+"^"+e}t.x_axis.scale=d3.scaleLog().domain(t.x_axis.domain).range(t.x_axis.range),t.x_axis.axis=er(t.x_axis.scale,o).ticks(t.x_axis.ticks.filter((t=>t.label.innerHTML)).length),m&&(t.x_axis.scale=t.x_axis.scale.base(m),t.x_axis.axis=t.x_axis.axis.tickFormat((t=>p||_?e(t):t)))}else t.x_axis.scale=(t.x_axis.domain[0]instanceof Date?d3.scaleTime():t.x_axis.ordinal.length?d3.scaleBand():d3.scaleLinear()).domain(t.x_axis.ordinal.length?t.x_axis.ordinal:t.x_axis.domain).range(t.x_axis.range),t.x_axis.axis=er(t.x_axis.scale,o).ticks(t.x_axis.ticks.length);return Math.abs(u-c)>.5?(t.y_axis.scale=d3.scaleLog().domain(t.y_axis.domain).range(t.y_axis.range),t.y_axis.axis=d3.axisLeft(t.y_axis.scale).tickSize(-t.y_axis.ticks[1].children[0].getAttribute("x2")).ticks(t.y_axis.ticks.length)):(t.y_axis.scale=(t.y_axis.domain[0]instanceof Date?d3.scaleTime():t.y_axis.ordinal.length?d3.scaleBand():d3.scaleLinear()).domain(t.y_axis.ordinal.length?t.y_axis.ordinal:t.y_axis.domain).range(t.y_axis.range),t.y_axis.axis=function(t,e){return tr(4,t,e)}(t.y_axis.scale,o).ticks(t.y_axis.ticks.length)),function(){if(o.state().x_axis.scale&&!o.state().x_axis.ordinal.length){let t=o.state().x_axis.ticks[0].ticks[0],e=o.state().x_axis.ticks[o.state().x_axis.ticks.length-1].ticks[0];t=+(t.hasAttribute("transform")?t.getAttribute("transform").match(/(-?\d+\.?-?\d*)/g)[0]:t._global_transform[0]-o.state().x_axis.global_range[0]),e=+(e.hasAttribute("transform")?e.getAttribute("transform").match(/(-?\d+\.?-?\d*)/g)[0]:e._global_transform[0]-o.state().x_axis.global_range[0]);let n=o.state().x_axis.range.map(o.state().x_axis.scale.copy().range([t,e]).invert,o.state().x_axis.scale);o.state().x_axis.scale.domain(n)}if(o.state().y_axis.scale&&!o.state().y_axis.ordinal.length){let t=o.state().y_axis.ticks[0].ticks[0],e=o.state().y_axis.ticks[o.state().y_axis.ticks.length-1].ticks[0];t=+(t.hasAttribute("transform")?t.getAttribute("transform").match(/(-?\d+\.?-?\d*)/g)[1]:t._global_transform[1]-o.state().y_axis.global_range[1]),e=+(e.hasAttribute("transform")?e.getAttribute("transform").match(/(-?\d+\.?-?\d*)/g)[1]:e._global_transform[1]-o.state().y_axis.global_range[1]);let n=o.state().y_axis.range.map(o.state().y_axis.scale.copy().range([e,t]).invert,o.state().y_axis.scale);o.state().y_axis.scale.domain(n)}}(),o},o}function rr(t){let e=Sn.parseSVG(t.getAttribute("d"));if(!e.length)return;t.contour=e;let n=e[e.length-1];3===e.length&&"A"===e[1].code&&"A"===n.code?t.type="ellipse":"Z"!==n.code?t.type="line":t.type="polygon"}function ir(t,e,r){if(t._global_transform=[...r],t.nodeName===n.SVG_GROUP){let e=t.getAttribute("transform");e&&(r[0]+=+e.match(/(\d+\.?\d*)/g)[0],r[1]+=+e.match(/(\d+\.?\d*)/g)[1])}else if("text"===t.nodeName)e.state().axis_text_marks.push(t);else for(const r of n.SVG_MARK)if(t.nodeName===r){let n=t.hasAttribute("x2")?+t.getAttribute("x2"):0,r=t.hasAttribute("y2")?+t.getAttribute("y2"):0;n&&e.state().y_axis.ticks.push(t),r&&e.state().x_axis.ticks.push(t)}for(const n of t.childNodes)ir(n,e,[...r])}function ar(t,e,r){if(null!==t){var i=!1;if(t._global_transform=[...r],t.nodeName===n.SVG_CONTAINER&&(e.state().svg=t),t.nodeName===n.SVG_GROUP){let n=t.getAttribute("transform");n&&(r[0]+=+n.match(/(\d+\.?\d*)/g)[0],r[1]+=+n.match(/(\d+\.?\d*)/g)[1]);let a=t.className.animVal;if(a.includes("legend"))i=!0;else if(a.includes("tick")||a.includes("grid")||a.includes("label")){i=!0;for(const n of t.childNodes)ir(n,e,[...r])}}else{let r=!1;for(const i of n.SVG_MARK){if("text"===t.nodeName&&(t.style["pointer-events"]="none",r||(e.state().text_marks.push(t),r=!0)),t.className&&("background"===t.className.animVal||"foreground"===t.className.animVal))break;if(t.nodeName===i){"path"===i&&rr(t),t.className&&t.className.animVal===n.TICK_DOMAIN?e.state().has_domain=!0:(t.setAttribute("__mark__","true"),t.__transform=t.hasAttribute("transform")?t.getAttribute("transform"):"translate(0, 0)",e.state().svg_marks.push(t));break}}}if(!i)for(const n of t.childNodes)ar(n,e,[...r])}}function or(t){let e=new nr;return ar(t,e,[0,0]),e.analyze_axes().infer_view().infer_mark_attributes(),console.log(e.state()),e}t.hydrate=function(t,e){let n=document.querySelector(t);if(!n)return;document.querySelector(e),function(t,e){for(const[t,n]of Object.entries(e.state().interactions)){n.control=document.querySelector("#"+t);const e=document.querySelector("#"+t+"_axis");e&&(n.axis_control=e)}return e}(0,or(n)).hydrate()},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=automatic-interaction.min.js.map
